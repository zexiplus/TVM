/*! tvvm.js v1.0.0 | MIT (c) 2018 float <zexiplus@outlook.com> | https://github.com/zexiplus/TVM#readme */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.TVVM=e()}(this,function(){"use strict";var e=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}();var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.subs=[]}return e(t,[{key:"addSubs",value:function(t){this.subs.push(t)}},{key:"notify",value:function(){this.subs.forEach(function(t){return t.update()})}}]),t}(),t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}();var i=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer(t)}return n(e,[{key:"observer",value:function(e){var n=this;e&&"object"===(void 0===e?"undefined":t(e))&&Object.keys(e).forEach(function(t){n.observer(e[t]),n.setReactive(e,t)})}},{key:"setReactive",value:function(e,n){var i=e[n],r=this,o=new a;Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:function(){return a.target&&o.addSubs(a.target),i},set:function(t){t!==e[n]&&(r.observer(t),i=t,o.notify())}})}}]),e}(),r=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}();var u=function(){function i(t,e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),this.vm=t,this.expr=e,this.cb=n,this.value=this.getValAndSetTarget()}return r(i,[{key:"getValAndSetTarget",value:function(){var t=(a.target=this).getValue(this.expr);return a.target=null,t}},{key:"getValue",value:function(t){return t.split(".").reduce(function(t,e){return t[e]},this.vm.$data)}},{key:"update",value:function(){var t=this.value,e=this.getValue(this.expr);t!==e&&this.cb&&this.cb(e)}}]),i}(),s={updateText:function(t,e,n,i){e&&(e.textContent=t)},"t-model":function(t,e,n,i){var r=this;e&&(e.value=t),e.addEventListener("input",function(t){r.setVal(n.$data,i,t.target.value)})},"t-if":function(t,e,n,i){var r=window.getComputedStyle(e);e&&(e.style.display=t?r:"none")},"t-show":function(t,e,n,i){var r=window.getComputedStyle(e);e&&(e.style.visibility=t?r:"hidden")},"t-for":function(t,e,n,i){var r=3+i.indexOf("in"),o=i.slice(r),a=i.slice(0,r-4),u=this.getVal(n.$data,o),c=/\{\{([^}]+)\}\}/g;if(!Array.isArray(u))return console.warn("t-for value must be an array");var l=e.parentElement;l.removeChild(e);var s=e.cloneNode(!0);s.setAttribute("t-scope",o),s.setAttribute("t-itemname",a),s.removeAttribute("t-for"),s.setAttribute("t-index",0),s.setAttribute("is-t-for","true"),u.forEach(function(t,e){var n=s.cloneNode(!0);if(n.setAttribute("t-index",e),n.textContent){var i=n.textContent.match(/\{\{([^}]+)\}\}/)[1],r=Function("item","return "+i)(t);n.textContent=n.textContent.replace(c,r)}l.appendChild(n)})},setVal:function(t,e,n){var i=e.split(".");i.reduce(function(t,e){if(i.indexOf(e)!=i.length-1)return t[e];t[e]=n},t)},getVal:function(t,e){return e.split(".").reduce(function(t,e){return t[e]},t)}},o=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}();var c=["is-t-for","t-index","t-scope","t-itemname"],l=function(){function i(t,e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),this.el=this.getDOM(t),this.vm=e,this.el){var n=this.toFragment(this.el);this.compile(n),this.el.appendChild(n)}else console.error("can not find element named "+t);this.vm.$el=this.el}return o(i,[{key:"compile",value:function(t){var n=this;t.childNodes.forEach(function(t,e){n.isElement(t)?(n.compile(t),n.compileNode(t)):n.isText(t)&&n.compileText(t)})}},{key:"compileText",value:function(e){var n=this,t=/\{\{([^}]+)\}\}/g,i=e.textContent;if(t.test(i))if(e.parentElement.getAttribute("t-for")||e.parentElement.getAttribute("is-t-for"));else{var r=i.replace(t,function(){return new u(n.vm,1<arguments.length?arguments[1]:void 0,function(t){s.updateText(t,e,n.vm)}),1<arguments.length?arguments[1]:void 0}),o=this.splitData(r,this.vm.$data);s.updateText(o,e,this.vm)}}},{key:"splitData",value:function(t,e){return(t&&t.split(".")).reduce(function(t,e){return t[e]},e)}},{key:"compileNode",value:function(c){var l=this,t=c.getAttributeNames();t.filter(this.isDirective).forEach(function(t){var e=c.getAttribute(t),n=l.splitData(e,l.vm.$data);s[t]?s[t](n,c,l.vm,e):l.isPrivateDirective(t)||l.isEventBinding(t)||console.warn("can't find directive "+t)}),t.filter(this.isEventBinding).forEach(function(t){var n=c.getAttribute(t),e=t.slice(1),i=/\(([^)]+)\)/,r=i.test(n),o=n.replace(i,""),a=l.splitData(o,l.vm.methods);if(c.getAttribute("is-t-for"))c.parentElement.addEventListener(e,function(t){if(t.target.getAttribute("is-t-for"))if(r){n.match(i)[1].split(",").map(function(t){return l.splitData(t.trim(),l.vm.$data)});var e=l.splitData(t.target.getAttribute("t-scope"),l.vm.$data)[t.target.getAttribute("t-index")];a.call(l.vm,e)}else a.call(l.vm)});else if(r){var u=n.match(i)[1].split(",").map(function(t){return l.splitData(t.trim(),l.vm.$data)});c.addEventListener(e,a.bind.apply(a,[l.vm].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(u))))}else c.addEventListener(e,a.bind(l.vm))})}},{key:"isPrivateDirective",value:function(t){return c.includes(t)}},{key:"isEventBinding",value:function(t){return/^@/.test(t)}},{key:"isDirective",value:function(t){return t.includes("t-")}},{key:"getDOM",value:function(t){return this.isElement(t)?t:document.querySelector(t)||null}},{key:"isElement",value:function(t){return 1===t.nodeType}},{key:"isText",value:function(t){return 3===t.nodeType}},{key:"toFragment",value:function(t){for(var e=document.createDocumentFragment(),n=void 0;n=t.firstChild;)e.appendChild(n);return e}}]),i}(),f=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}();var d=function(){function n(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.hooks={},this.init(t,e),e.lifecycle=this,e.callHook=this.callHook.bind(this)}return f(n,[{key:"init",value:function(t,n){var i={beforeCreate:t.beforeCreate,created:t.created,beforeMount:t.beforeMount,mounted:t.mounted,beforeUpdate:t.beforeUpdate,updated:t.updated,beforeDestory:t.beforeDestory,destoried:t.destoried};Object.keys(i).forEach(function(t,e){void 0===i[t]&&(i[t]=v),i[t]=i[t]instanceof Function?i[t].bind(n):(console.warn("lifecycle hooks must be a function"),v)}),this.hooks=i}},{key:"callHook",value:function(t){this.hooks[t]()}}]),n}();function v(){}var h=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}();return function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),new d(t,this),this.callHook("beforeCreate"),this.$data="function"==typeof t.data?t.data():t.data,this.methods=t.methods,this.proxy(this.$data,this),this.proxy(t.methods,this),t.el&&(new i(this.$data),this.callHook("created"),this.callHook("beforeMount"),new l(t.el,this),this.callHook("mounted"))}return h(e,[{key:"proxy",value:function(n,i){Object.keys(n).forEach(function(e){Object.defineProperty(i,e,{enumerable:!0,configurable:!0,get:function(){return n[e]},set:function(t){void 0!==i[e]&&console.warn("key "+e+" has already in Target"),n[e]=t}})})}}]),e}()});